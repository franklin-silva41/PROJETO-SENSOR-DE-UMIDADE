(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{"./app/gamma/src/components/popovers/account-switcher/add-account.less":function(e,t,n){var o=n("./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/add-account.less");"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(o,a);o.locals&&(e.exports=o.locals)},"./app/gamma/src/components/popovers/account-switcher/add-account.tsx":function(e,t,n){"use strict";n.r(t),n.d(t,"AddAccount",(function(){return w}));var o=n("./node_modules/react/index.js"),a=n.n(o),r=n("./app/gamma/src/components/popovers/account-switcher/add-account.less"),c=n.n(r),s=n("./app/common/lib/util/i18n/index.ts"),i=n("./app/common/components/controls/button/button.tsx"),u=n("./packages/storage/index.ts"),l=n("./packages/atlassian-analytics/index.ts"),d=n("./packages/config/index.ts");function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,a=!1,r=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done)&&(n.push(c.value),!t||n.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function f(e,t,n,o,a,r,c){try{var s=e[r](c),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(o,a)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function c(e){f(r,o,a,c,s,"next",e)}function s(e){f(r,o,a,c,s,"throw",e)}c(void 0)}))}}var h=Object(s.forTemplate)("header_account_switcher"),b=function(e){l.Analytics.sendTrackEvent({action:"failed",actionSubject:"accountSwitcher",source:"accountSwitcherAddAccountInlineDialog",attributes:{reason:e||"Trello account not found"}})},v=function(){var e=g(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({email:t}).toString(),e.next=3,fetch("/auth/accountSwitcher/policy?".concat(n),{method:"GET",headers:{"X-Trello-Client-Version":d.clientVersion,credentials:"include"}});case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("error getting account switcher policy");case 6:return e.abrupt("return",o.json());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(e){var t=e.initialEmail,n=e.policy,r=p(Object(o.useState)(!1),2),s=r[0],d=r[1],m=p(Object(o.useState)(""),2),f=m[0],w=m[1],x=p(Object(o.useState)(n||{url:"",reason:""}),2),y=x[0],_=x[1],A=function(){var e=g(regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _({url:"",reason:""}),d(!1),e.prev=2,e.next=5,v(f);case 5:t=e.sent,n=t.url,(o=t.reason)&&0===n.indexOf(window.location.origin)?(b(o),_({url:n,reason:o})):n&&(l.Analytics.sendTrackEvent({action:"added",actionSubject:"accountSwitcher",source:"accountSwitcherAddAccountInlineDialog"}),u.TrelloStorage.set("accountSwitcherAccountAdded","true"),window.location.href=n),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),_({url:"",reason:"not found"}),b(null);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){l.Analytics.sendScreenEvent({name:"accountSwitcherAddAccountInlineDialog"})}),[]);return a.a.createElement("div",{className:c.a.addAccount},a.a.createElement("p",{className:c.a.instructions},h("enter-the-email-for-the-account-youd-like-to-add")),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),s&&A()}},a.a.createElement("input",{className:c.a.email,placeholder:h("enter-email"),onChange:function(e){d(e.currentTarget.value.length>0),w(e.currentTarget.value),_({url:"",reason:""})},value:t}),"not found"===y.reason&&a.a.createElement("p",{className:c.a.notFoundError},h("there-isnt-an-account-for-this-email")),"migration ineligible"!==y.reason&&"migration required"!==y.reason&&a.a.createElement(i.a,{disabled:!s,className:c.a.continueButton,onClick:A,buttonType:i.c.PRIMARY},h("continue"))),("migration ineligible"===y.reason||"migration required"===y.reason)&&a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{className:c.a.addAccountError},h("this-account-requires-a-few-updates-before-it-can-be-added")),a.a.createElement(i.a,{className:c.a.upgradeButton,buttonType:i.c.PRIMARY,onClick:function(){u.TrelloStorage.set("accountSwitcherAccountAdded","true"),l.Analytics.sendUIEvent({action:"clicked",actionSubject:"button",source:"accountSwitcherAddAccountInlineDialog",actionSubjectId:"accountSwitcherLoginAndUpdateButton"}),window.location.href=y.url}},h("log-in-and-update"))))};t.default=w},"./app/gamma/src/components/popovers/account-switcher/upgrade-account.less":function(e,t,n){var o=n("./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/upgrade-account.less");"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(o,a);o.locals&&(e.exports=o.locals)},"./app/gamma/src/components/popovers/account-switcher/upgrade-account.tsx":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/react/index.js"),a=n.n(o),r=n("./app/gamma/src/components/popovers/account-switcher/upgrade-account.less"),c=n.n(r),s=n("./app/common/lib/util/i18n/index.ts"),i=n("./app/common/components/controls/button/button.tsx"),u=Object(s.forTemplate)("header_account_switcher");t.default=function(e){var t=e.onClickUpdateAccount,n=e.isMigratable;return a.a.createElement("div",{className:c.a.upgradeAccount},a.a.createElement("div",{className:c.a.blurb},u("your-account-requires-a-few-updates-before-it-can-be-added")),a.a.createElement("div",{className:c.a.cta},n&&a.a.createElement(i.a,{onClick:t,buttonType:i.c.PRIMARY},u("continue"))))}},"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/add-account.less":function(e,t,n){(t=e.exports=n("./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"._2Hub384akCIg4r{padding:12px 12px 0}._3E-bYiUcmFOGhY{width:100%}._2aixxlBRRm9BRE,._3HQEZKzDsIMz9N{font-size:12px;color:#eb5a46}._7X0QYIftbm3_R2{padding:0 12px 12px;font-size:12px}",""]),t.locals={addAccount:"_2Hub384akCIg4r",email:"_3E-bYiUcmFOGhY",addAccountError:"_3HQEZKzDsIMz9N",notFoundError:"_2aixxlBRRm9BRE",tip:"_7X0QYIftbm3_R2"}},"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/upgrade-account.less":function(e,t,n){(t=e.exports=n("./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"._2ts1p3-z_x9KSu{display:flex;flex-direction:column;align-items:flex-start}._2zSak0Iwd8uyd5{margin:4px;padding:4px}.rq2cw3x9rL3AAy{margin:8px}",""]),t.locals={upgradeAccount:"_2ts1p3-z_x9KSu",blurb:"_2zSak0Iwd8uyd5",cta:"rq2cw3x9rL3AAy"}}}]);
//# sourceMappingURL=header-member-menu-add-account.4c2bfd4664751e47ab64.js.map